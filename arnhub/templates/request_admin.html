{% extends "base.html" %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-black via-purple-900 to-black text-white py-10 px-4">
    <div class="max-w-xl mx-auto bg-zinc-900 p-8 rounded-2xl shadow-xl animate-fade-in">
        <h1 class="text-3xl font-bold text-center text-purple-300 mb-6">Request Admin Access</h1>

        {% if existing_request %}
            {% if existing_request.status == 'pending' %}
            <div class="bg-blue-900 text-blue-200 text-sm px-4 py-3 rounded-lg mb-6 border border-blue-600">
                <p><strong>Your request is currently under review.</strong></p>
                <p class="mt-2 text-gray-300">Reason you submitted: 
                    <span class="text-white">{{ existing_request.reason }}</span></p>
                <p class="mt-2 italic">You will be notified once a decision is made by the head admin.</p>
            </div>
            {% elif existing_request.status == 'approved' %}
            <div class="bg-green-900 text-green-200 text-sm px-4 py-3 rounded-lg mb-6 border border-green-600">
                <p><strong>Your admin request has been approved.</strong></p>
                <p class="mt-2">You already have admin access.</p>
            </div>
            {% elif existing_request.status == 'rejected' %}
            <div class="bg-red-900 text-red-200 text-sm px-4 py-3 rounded-lg mb-6 border border-red-600">
                <p><strong>Your previous request was rejected.</strong></p>
                {% if existing_request.comment %}
                <p class="mt-2 italic text-red-300">Reason: {{ existing_request.comment }}</p>
                {% else %}
                <p class="mt-2">No rejection reason provided.</p>
                {% endif %}
                <p class="mt-2">You may resubmit your request with a new explanation.</p>
            </div>
            {% elif existing_request.status == 'revoked' %}
            <div class="bg-yellow-900 text-yellow-200 text-sm px-4 py-3 rounded-lg mb-6 border border-yellow-600">
                <p><strong>Your admin access was previously revoked.</strong></p>
                {% if existing_request.comment %}
                <p class="mt-2 italic text-yellow-300">Reason: {{ existing_request.comment }}</p>
                {% else %}
                <p class="mt-2">No revocation reason provided.</p>
                {% endif %}
                <p class="mt-2">You may submit a new request with justification.</p>
            </div>
            {% endif %}
        {% endif %}

        {% if not existing_request or existing_request.status in ['rejected', 'revoked'] %}
        <form method="POST">
            <label for="reason" class="block text-sm font-semibold text-purple-200 mb-2">
                Why do you need admin access?
            </label>
            <textarea name="reason" id="reason" rows="4"
                class="w-full p-3 rounded-lg bg-zinc-800 text-white border border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-600 resize-none"
                placeholder="Explain your reason...">{{ existing_request.reason if existing_request else '' }}</textarea>

            <div class="bg-zinc-800 text-yellow-100 text-sm px-4 py-3 rounded-lg mt-6 border border-yellow-600">
                <p class="font-semibold mb-1">⚠️ Please read before submitting:</p>
                <ul class="list-disc ml-6 space-y-1">
                    <li>You must have at least one course to add or manage.</li>
                    <li>Do not request admin access if you're only a student.</li>
                    <li>Abusive or fake requests will be rejected permanently.</li>
                    <li>Your request will expire automatically after 7 days if not approved.</li>
                    <li>Contact us at <strong>arncode.app@gmail.com</strong> for assistance.</li>
                </ul>
            </div>

            <button type="submit"
                class="w-full mt-6 bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg shadow-md">
                Submit Request
            </button>
        </form>
        {% endif %}
    </div>
</div>
{% endblock %}